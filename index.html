<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡ÆÜ‡Æ∞‡Øã‡Æï‡Øç‡Æï‡Æø‡ÆØ ‡Æ™‡ÆØ‡Æ©‡Øç‡Æ™‡Ææ‡Æü‡ØÅ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Tamil:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Noto Sans Tamil', sans-serif;
            transition: background-color 0.5s ease;
        }
        .pain-map-svg .body-part:hover {
            fill: #4299e1;
            cursor: pointer;
            transition: fill 0.3s ease;
        }
        .pain-map-svg .body-part.pain {
            fill: #ef4444;
        }
        .fixed-bottom-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
        }
        .pain-map-container {
            width: 100%;
            max-width: 400px;
            height: auto;
            margin: 0 auto;
        }
        .output-box {
            width: 100%;
            padding: 1.5rem;
            background-color: #f3f4f6;
            border-radius: 1rem;
            box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06);
            min-height: 100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: #4b5563;
            overflow-y: auto;
        }
        .output-box-container {
            position: relative;
            width: 100%;
        }
        .output-box-actions {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
        }
        .loading-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #4f46e5;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-100 antialiased text-gray-800">

<div id="app" class="min-h-screen flex flex-col items-center justify-center p-4"></div>

<div id="bottom-bar" class="fixed-bottom-bar flex justify-center items-center gap-4 p-4 hidden"></div>

<div id="message-box" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center p-4 z-50">
    <div class="bg-white p-6 rounded-lg shadow-xl max-w-sm w-full">
        <p class="text-lg font-medium text-gray-800 text-center" id="message-text"></p>
        <button onclick="closeMessageBox()" class="mt-4 w-full py-2 bg-indigo-600 text-white font-semibold rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
            ‡Æö‡Æ∞‡Æø
        </button>
    </div>
</div>

<script type="module">
    // ‡ÆÆ‡Øä‡Æ¥‡Æø‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øç‡Æ™‡Øç‡Æ™‡ØÅ‡Æï‡Æ≥‡Øç
    const translations = {
        'ta': {
            loginTitle: 'üîí‡Æâ‡Æ≥‡Øç‡Æ®‡ØÅ‡Æ¥‡Øà‡Æï',
            usernamePlaceholder: '‡Æ™‡ÆØ‡Æ©‡Æ∞‡Øç ‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øç',
            passwordPlaceholder: '‡Æï‡Æü‡Æµ‡ØÅ‡Æö‡Øç‡Æö‡Øä‡Æ≤‡Øç',
            loginButton: '‡Æâ‡Æ≥‡Øç‡Æ®‡ØÅ‡Æ¥‡Øà‡ÆØ',
            loginError: '‡Æ§‡ÆØ‡Æµ‡ØÅ‡Æö‡ØÜ‡ÆØ‡Øç‡Æ§‡ØÅ ‡Æ™‡ÆØ‡Æ©‡Æ∞‡Øç ‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øç ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æï‡Æü‡Æµ‡ØÅ‡Æö‡Øç‡Æö‡Øä‡Æ≤‡Øç‡Æ≤‡Øà ‡Æâ‡Æ≥‡Øç‡Æ≥‡Æø‡Æü‡Æµ‡ØÅ‡ÆÆ‡Øç.',
            allFeaturesTitle: '‡ÆÖ‡Æ©‡Øà‡Æ§‡Øç‡Æ§‡ØÅ ‡ÆÜ‡Æ∞‡Øã‡Æï‡Øç‡Æï‡Æø‡ÆØ ‡ÆÖ‡ÆÆ‡Øç‡Æö‡Æô‡Øç‡Æï‡Æ≥‡Øç',
            backToFeatures: '‡ÆÖ‡ÆÆ‡Øç‡Æö‡Æô‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æ§‡Æø‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡ØÅ',
            featureNotDeveloped: '‡Æá‡Æ®‡Øç‡Æ§ ‡ÆÖ‡ÆÆ‡Øç‡Æö‡ÆÆ‡Øç ‡Æá‡Æ©‡Øç‡Æ©‡ØÅ‡ÆÆ‡Øç ‡Æâ‡Æ∞‡ØÅ‡Æµ‡Ææ‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Æµ‡Æø‡Æ≤‡Øç‡Æ≤‡Øà.',
            mainMenuTitle: '‡ÆÆ‡ØÅ‡Æï‡Øç‡Æï‡Æø‡ÆØ ‡ÆÆ‡ØÜ‡Æ©‡ØÅ',
            stepTracker: '‡Æ™‡Æü‡Æø ‡Æï‡Æ£‡Øç‡Æï‡Ææ‡Æ£‡Æø‡Æ™‡Øç‡Æ™‡ØÅ',
            heartRate: '‡Æá‡Æ§‡ÆØ‡Æ§‡Øç ‡Æ§‡ØÅ‡Æü‡Æø‡Æ™‡Øç‡Æ™‡ØÅ',
            waterIntake: '‡Æ®‡ØÄ‡Æ∞‡Øç ‡Æâ‡Æü‡Øç‡Æï‡Øä‡Æ≥‡Øç‡Æ≥‡Æ≤‡Øç',
            moodJournal: '‡ÆÆ‡Æ©‡Æ®‡Æø‡Æ≤‡Øà & ‡Æ®‡Æ©‡Øç‡Æ±‡Æø‡ÆØ‡ØÅ‡Æ£‡Æ∞‡Øç‡Æµ‡ØÅ ‡Æ®‡Ææ‡Æü‡Øç‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡ØÅ',
            medicationReminder: '‡ÆÆ‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡ØÅ ‡Æ®‡Æø‡Æ©‡Øà‡Æµ‡ØÇ‡Æü‡Øç‡Æü‡Æ≤‡Øç',
            foodPlan: '‡Æâ‡Æ£‡Æµ‡ØÅ‡Æ§‡Øç ‡Æ§‡Æø‡Æü‡Øç‡Æü‡ÆÆ‡Øç',
            exerciseYoga: '‡Æâ‡Æü‡Æ±‡Øç‡Æ™‡ÆØ‡Æø‡Æ±‡Øç‡Æö‡Æø & ‡ÆØ‡Øã‡Æï‡Ææ',
            bodyPainMap: '‡Æâ‡Æü‡Æ≤‡Øç ‡Æµ‡Æ≤‡Æø ‡Æµ‡Æ∞‡Øà‡Æ™‡Æü‡ÆÆ‡Øç',
            generalTips: '‡Æ™‡Øä‡Æ§‡ØÅ‡Æµ‡Ææ‡Æ© ‡Æö‡ØÅ‡Æï‡Ææ‡Æ§‡Ææ‡Æ∞ ‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡ØÅ‡Æï‡Æ≥‡Øç',
            localTips: '‡Æâ‡Æ≥‡Øç‡Æ≥‡ØÇ‡Æ∞‡Øç ‡Æö‡ØÅ‡Æï‡Ææ‡Æ§‡Ææ‡Æ∞ ‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡ØÅ‡Æï‡Æ≥‡Øç',
            beautyTips: '‡Æµ‡ØÄ‡Æü‡Øç‡Æü‡ØÅ ‡ÆÖ‡Æ¥‡Æï‡ØÅ ‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡ØÅ‡Æï‡Æ≥‡Øç',
            symptomFinder: '‡ÆÖ‡Æ±‡Æø‡Æï‡ØÅ‡Æ±‡Æø‡Æï‡Æ≥‡Øç ‡Æï‡Æ£‡Øç‡Æü‡ØÅ‡Æ™‡Æø‡Æü‡Æø‡Æ™‡Øç‡Æ™‡ØÅ AI',
            firstAid: '‡ÆÆ‡ØÅ‡Æ§‡Æ≤‡ØÅ‡Æ§‡Æµ‡Æø & ‡ÆÖ‡Æµ‡Æö‡Æ∞‡ÆÆ‡Øç',
            foodRecipes: '‡Æâ‡Æ£‡Æµ‡ØÅ ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆÆ‡ØÅ‡Æ±‡Øà‡Æï‡Æ≥‡Øç',
            search: '‡Æ§‡Øá‡Æü‡ØÅ',
            submit: '‡Æö‡ÆÆ‡Æ∞‡Øç‡Æ™‡Øç‡Æ™‡Æø',
            yourTipHere: '‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡ØÅ ‡Æá‡Æô‡Øç‡Æï‡Øá ‡Æ§‡Øã‡Æ©‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç.',
            noRecipe: '‡Æö‡ØÜ‡ÆØ‡Øç‡ÆÆ‡ØÅ‡Æ±‡Øà ‡Æé‡Æ§‡ØÅ‡Æµ‡ØÅ‡ÆÆ‡Øç ‡Æï‡Æø‡Æü‡Øà‡Æï‡Øç‡Æï‡Æµ‡Æø‡Æ≤‡Øç‡Æ≤‡Øà. ‡ÆÆ‡ØÄ‡Æ£‡Øç‡Æü‡ØÅ‡ÆÆ‡Øç ‡ÆÆ‡ØÅ‡ÆØ‡Æ±‡Øç‡Æö‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç.',
            loadingMessage: 'AI ‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡Øà ‡Æâ‡Æ∞‡ØÅ‡Æµ‡Ææ‡Æï‡Øç‡Æï‡ØÅ‡Æï‡Æø‡Æ±‡Æ§‡ØÅ...',
            inputPlaceholderGeneral: '‡Æ®‡ØÄ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æµ‡Æø‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡ØÅ‡ÆÆ‡Øç ‡Æ™‡Øä‡Æ§‡ØÅ‡Æµ‡Ææ‡Æ© ‡Æö‡ØÅ‡Æï‡Ææ‡Æ§‡Ææ‡Æ∞ ‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡ØÅ‡Æï‡Æ≥‡Øà‡Æ™‡Øç ‡Æ™‡ØÜ‡Æ±‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç.',
            inputPlaceholderBeauty: '‡Æ®‡ØÄ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æµ‡Æø‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡ØÅ‡ÆÆ‡Øç ‡ÆÖ‡Æ¥‡Æï‡ØÅ ‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡ØÅ‡Æï‡Æ≥‡Øà‡Æ™‡Øç ‡Æ™‡ØÜ‡Æ±‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç.',
            inputPlaceholderLocal: '‡Æ®‡ØÄ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æµ‡Æø‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡ØÅ‡ÆÆ‡Øç ‡Æâ‡Æ≥‡Øç‡Æ≥‡ØÇ‡Æ∞‡Øç ‡Æö‡ØÅ‡Æï‡Ææ‡Æ§‡Ææ‡Æ∞ ‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡ØÅ‡Æï‡Æ≥‡Øà‡Æ™‡Øç ‡Æ™‡ØÜ‡Æ±‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç.',
            inputPlaceholderSymptom: '‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡ÆÖ‡Æ±‡Æø‡Æï‡ØÅ‡Æ±‡Æø‡Æï‡Æ≥‡Øç ‡Æ™‡Æ±‡Øç‡Æ±‡Æø‡ÆØ ‡Æ§‡Æï‡Æµ‡Æ≤‡Øç‡Æï‡Æ≥‡Øà‡Æ™‡Øç ‡Æ™‡ØÜ‡Æ±‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç.',
            inputPlaceholderRecipes: '‡Æí‡Æ∞‡ØÅ ‡Æâ‡Æ£‡Æµ‡Æø‡Æ©‡Øç ‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øç ‡ÆÖ‡Æ≤‡Øç‡Æ≤‡Æ§‡ØÅ ‡ÆÆ‡ØÇ‡Æ≤‡Æ™‡Øç‡Æ™‡Øä‡Æ∞‡ØÅ‡Æü‡Øç‡Æï‡Æ≥‡Øà ‡Æâ‡Æ≥‡Øç‡Æ≥‡Æø‡Æü‡Øç‡Æü‡ØÅ ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆÆ‡ØÅ‡Æ±‡Øà‡ÆØ‡Øà‡Æ™‡Øç ‡Æ™‡ØÜ‡Æ±‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç.',
            getTip: '‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡Øà‡Æ™‡Øç ‡Æ™‡ØÜ‡Æ±‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç',
            stepsCount: '‡Æ™‡Æü‡Æø‡Æï‡Æ≥‡Øç: ',
            startTracking: '‡Æï‡Æ£‡Øç‡Æï‡Ææ‡Æ£‡Æø‡Æ™‡Øç‡Æ™‡Øà ‡Æ§‡Øä‡Æü‡Æô‡Øç‡Æï‡ØÅ',
            stopTracking: '‡Æï‡Æ£‡Øç‡Æï‡Ææ‡Æ£‡Æø‡Æ™‡Øç‡Æ™‡Øà ‡Æ®‡Æø‡Æ±‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ',
            reset: '‡Æ™‡Æü‡Æø‡Æï‡Æ≥‡Øà ‡ÆÆ‡ØÄ‡Æü‡Øç‡Æü‡ÆÆ‡Øà',
            stepMotivation: '‡Æí‡Æ∞‡ØÅ ‡Æ®‡Ææ‡Æ≥‡Øà‡Æï‡Øç‡Æï‡ØÅ 10,000 ‡Æ™‡Æü‡Æø‡Æï‡Æ≥‡Øç ‡Æ®‡Æü‡Æ™‡Øç‡Æ™‡Æ§‡ØÅ ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡ÆÜ‡Æ∞‡Øã‡Æï‡Øç‡Æï‡Æø‡ÆØ‡Æ§‡Øç‡Æ§‡Øà ‡Æï‡Æ£‡Æø‡Æö‡ÆÆ‡Ææ‡Æï ‡ÆÆ‡Øá‡ÆÆ‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ‡ÆÆ‡Øç.',
            journalPrompt: '‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡ÆÆ‡Æ©‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡Øà‡ÆØ‡ØÅ‡ÆÆ‡Øç, ‡Æ®‡ØÄ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ®‡Æ©‡Øç‡Æ±‡Æø‡ÆØ‡ØÅ‡Æ≥‡Øç‡Æ≥ ‡Æµ‡Æø‡Æ∑‡ÆØ‡Æô‡Øç‡Æï‡Æ≥‡Øà‡ÆØ‡ØÅ‡ÆÆ‡Øç ‡Æ§‡Æø‡Æ©‡ÆÆ‡ØÅ‡ÆÆ‡Øç ‡Æ™‡Æ§‡Æø‡Æµ‡ØÅ ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆØ‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç.',
            moodSelect: '-- ‡ÆÆ‡Æ©‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡Øà‡Æ§‡Øç ‡Æ§‡Øá‡Æ∞‡Øç‡Æµ‡ØÅ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆØ‡Æµ‡ØÅ‡ÆÆ‡Øç --',
            moodHappy: '‡ÆÆ‡Æï‡Æø‡Æ¥‡Øç‡Æö‡Øç‡Æö‡Æø',
            moodSad: '‡Æö‡Øã‡Æï‡ÆÆ‡Øç',
            moodNormal: '‡Æö‡Ææ‡Æ§‡Ææ‡Æ∞‡Æ£‡ÆÆ‡Øç',
            moodAnxious: '‡Æ™‡Æ§‡Æü‡Øç‡Æü‡ÆÆ‡Øç',
            moodGrateful: '‡Æ®‡Æ©‡Øç‡Æ±‡Æø‡ÆØ‡ØÅ‡Æ£‡Æ∞‡Øç‡Æµ‡ØÅ',
            saveEntry: '‡Æ™‡Æ§‡Æø‡Æµ‡Øà ‡Æö‡Øá‡ÆÆ‡Æø',
            analyzeMood: '‡ÆÆ‡Æ©‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡Øà ‡Æ™‡Æï‡ØÅ‡Æ™‡Øç‡Æ™‡Ææ‡ÆØ‡Øç‡Æµ‡ØÅ ‡Æö‡ØÜ‡ÆØ‡Øç',
            moodAnalysis: '‡ÆÆ‡Æ©‡Æ®‡Æø‡Æ≤‡Øà ‡Æ™‡Æï‡ØÅ‡Æ™‡Øç‡Æ™‡Ææ‡ÆØ‡Øç‡Æµ‡ØÅ',
            moodAnalysisPlaceholder: '‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡ÆÆ‡Æ©‡Æ®‡Æø‡Æ≤‡Øà ‡Æ™‡Æï‡ØÅ‡Æ™‡Øç‡Æ™‡Ææ‡ÆØ‡Øç‡Æµ‡ØÅ ‡Æá‡Æô‡Øç‡Æï‡Øá ‡Æ§‡Øã‡Æ©‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç.',
            yourEntries: '‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ™‡Æ§‡Æø‡Æµ‡ØÅ‡Æï‡Æ≥‡Øç',
            entriesPlaceholder: '‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ®‡Ææ‡Æü‡Øç‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡ØÅ ‡Æ™‡Æ§‡Æø‡Æµ‡ØÅ‡Æï‡Æ≥‡Øç ‡Æá‡Æô‡Øç‡Æï‡Øá ‡Æ§‡Øã‡Æ©‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç.',
            foodPlanPrompt: '‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æâ‡Æ£‡Æµ‡ØÅ, ‡Æâ‡Æü‡Æ≤‡Øç‡Æ®‡Æ≤‡ÆÆ‡Øç, ‡Æí‡Æµ‡Øç‡Æµ‡Ææ‡ÆÆ‡Øà ‡ÆÖ‡Æ≤‡Øç‡Æ≤‡Æ§‡ØÅ ‡Æ™‡Æø‡Æ∞‡Æö‡Øç‡Æö‡Æ©‡Øà‡ÆØ‡Øà ‡Æâ‡Æ≥‡Øç‡Æ≥‡Æø‡Æü‡Æµ‡ØÅ‡ÆÆ‡Øç.',
            painMapPrompt: '‡Æâ‡Æü‡Æ≤‡Æø‡Æ©‡Øç ‡Æé‡Æ®‡Øç‡Æ§‡Æ™‡Øç ‡Æ™‡Æï‡ØÅ‡Æ§‡Æø‡ÆØ‡Æø‡Æ≤‡Øç ‡Æµ‡Æ≤‡Æø ‡Æá‡Æ∞‡ØÅ‡Æï‡Øç‡Æï‡Æø‡Æ±‡Æ§‡Øã, ‡ÆÖ‡Æ§‡Øà‡Æ§‡Øç ‡Æ§‡Øä‡Æü‡Øç‡Æü‡ØÅ ‡Æµ‡Æ≤‡Æø ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡ÆÖ‡Æ§‡Æ©‡Øç ‡Æµ‡Æø‡Æ≥‡Æï‡Øç‡Æï‡Æ§‡Øç‡Æ§‡Øà ‡Æö‡Øá‡Æ∞‡Øç‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç.',
            removePain: '‡Æ®‡ØÄ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡ÆÖ‡Æ§‡Øà ‡ÆÆ‡ØÄ‡Æ£‡Øç‡Æü‡ØÅ‡ÆÆ‡Øç ‡ÆÖ‡Æ¥‡ØÅ‡Æ§‡Øç‡Æ§‡Æø‡Æ©‡Ææ‡Æ≤‡Øç ‡Æµ‡Æ≤‡Æø ‡Æ®‡ØÄ‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡ØÅ‡ÆÆ‡Øç.',
            aiTipTitle: 'AI ‡Æâ‡Æ§‡Æµ‡Æø‡Æï‡Øç‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡ØÅ',
            firstAidPrompt: '‡ÆÖ‡Æµ‡Æö‡Æ∞ ‡Æï‡Ææ‡Æ≤‡Æô‡Øç‡Æï‡Æ≥‡Æø‡Æ≤‡Øç ‡Æâ‡Æ§‡Æµ‡Æø‡Æï‡Æ≥‡Øç ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æ§‡Æï‡Æµ‡Æ≤‡Øç‡Æï‡Æ≥‡Øà ‡Æ™‡ØÜ‡Æ±‡Æµ‡ØÅ‡ÆÆ‡Øç.',
            emergencyContacts: '‡ÆÖ‡Æµ‡Æö‡Æ∞ ‡Æ§‡Øä‡Æü‡Æ∞‡Øç‡Æ™‡ØÅ‡Æï‡Æ≥‡Øç',
            addContact: '‡Æ§‡Øä‡Æü‡Æ∞‡Øç‡Æ™‡Øà ‡Æö‡Øá‡Æ∞‡Øç',
            noContacts: '‡ÆÖ‡Æµ‡Æö‡Æ∞ ‡Æ§‡Øä‡Æü‡Æ∞‡Øç‡Æ™‡ØÅ‡Æï‡Æ≥‡Øç ‡Æé‡Æ§‡ØÅ‡Æµ‡ØÅ‡ÆÆ‡Øç ‡Æá‡Æ≤‡Øç‡Æ≤‡Øà.',
            symptomPrompt: '‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡ÆÖ‡Æ±‡Æø‡Æï‡ØÅ‡Æ±‡Æø‡Æï‡Æ≥‡Øç ‡Æ™‡Æ±‡Øç‡Æ±‡Æø‡ÆØ ‡Æ§‡Æï‡Æµ‡Æ≤‡Øç‡Æï‡Æ≥‡Øà‡Æ™‡Øç ‡Æ™‡ØÜ‡Æ±‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç.',
            exercisePrompt: '‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æâ‡Æü‡Æ±‡Øç‡Æ™‡ÆØ‡Æø‡Æ±‡Øç‡Æö‡Æø, ‡Æµ‡Æ≤‡Æø ‡ÆÖ‡Æ≤‡Øç‡Æ≤‡Æ§‡ØÅ ‡Æ™‡Æø‡Æ∞‡Æö‡Øç‡Æö‡Æ©‡Øà‡Æï‡Øç‡Æï‡Ææ‡Æ© ‡ÆØ‡Øã‡Æö‡Æ©‡Øà‡Æï‡Æ≥‡Øà ‡Æâ‡Æ≥‡Øç‡Æ≥‡Æø‡Æü‡Æµ‡ØÅ‡ÆÆ‡Øç.',
            painPromptPrefix: '‡Æá‡Æ®‡Øç‡Æ§ ‡Æâ‡Æü‡Æ±‡Øç‡Æ™‡Æï‡ØÅ‡Æ§‡Æø ‡Æµ‡Æ≤‡Æø‡Æï‡Øç‡Æï‡ØÅ ‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡ØÅ‡Æï‡Æ≥‡Øç:',
            painMapTipInstructions: '‡Æµ‡Æ≤‡Æø ‡Æâ‡Æ≥‡Øç‡Æ≥ ‡Æ™‡Æï‡ØÅ‡Æ§‡Æø‡ÆØ‡Øà‡Æ§‡Øç ‡Æ§‡Øä‡Æü‡Øç‡Æü‡ØÅ, ‡ÆÖ‡Æ§‡Æ©‡Øç ‡Æ™‡Æ±‡Øç‡Æ±‡Æø‡ÆØ ‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡ØÅ‡Æï‡Æ≥‡Øà‡Æ™‡Øç ‡Æ™‡ØÜ‡Æ±‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç.',
            genericPainTip: '‡Æâ‡Æü‡Æ≤‡Øç ‡Æµ‡Æ≤‡Æø‡Æï‡Øç‡Æï‡ØÅ ‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡ØÅ‡Æï‡Æ≥‡Øà‡Æ™‡Øç ‡Æ™‡ØÜ‡Æ± ‡Æí‡Æ∞‡ØÅ ‡Æâ‡Æü‡Æ≤‡Øç ‡Æ™‡Æï‡ØÅ‡Æ§‡Æø‡ÆØ‡Øà‡Æ§‡Øç ‡Æ§‡Øä‡Æü‡Æµ‡ØÅ‡ÆÆ‡Øç.',
            micListening: '‡Æï‡Øá‡Æü‡Øç‡Æï‡Æø‡Æ±‡Æ§‡ØÅ...',
            micStopped: '‡ÆÆ‡Øà‡Æï‡Øç‡Æ∞‡Øã‡ÆÉ‡Æ™‡Øã‡Æ©‡Øç ‡Æ®‡Æø‡Æ±‡ØÅ‡Æ§‡Øç‡Æ§‡Æø‡Æµ‡Æø‡Æü‡Øç‡Æü‡Æ§‡ØÅ.',
            speakTip: '‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡Øà‡Æ™‡Øç ‡Æ™‡Øá‡Æö‡Æµ‡ØÅ‡ÆÆ‡Øç',
            stopSpeaking: '‡Æ™‡Øá‡Æö‡ØÅ‡Æµ‡Æ§‡Øà ‡Æ®‡Æø‡Æ±‡ØÅ‡Æ§‡Øç‡Æ§‡Æµ‡ØÅ‡ÆÆ‡Øç',
            motionSensorNotSupported: '‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æö‡Ææ‡Æ§‡Æ©‡ÆÆ‡Øç ‡ÆÆ‡Øã‡Æ∑‡Æ©‡Øç ‡Æö‡ØÜ‡Æ©‡Øç‡Æö‡Ææ‡Æ∞‡Øà ‡ÆÜ‡Æ§‡Æ∞‡Æø‡Æï‡Øç‡Æï‡Æµ‡Æø‡Æ≤‡Øç‡Æ≤‡Øà. (Your device does not support motion sensors).',
            emergencyTip: '‡ÆÖ‡Æµ‡Æö‡Æ∞ ‡Æâ‡Æ§‡Æµ‡Æø‡Æï‡Øç‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡ØÅ',
            viewFront: '‡ÆÆ‡ØÅ‡Æ©‡Øç‡Æ™‡Æï‡Øç‡Æï ‡Æ™‡Ææ‡Æ∞‡Øç‡Æµ‡Øà',
            viewBack: '‡Æ™‡Æø‡Æ©‡Øç‡Æ§‡Æø‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡Æø‡ÆØ ‡Æ™‡Ææ‡Æ∞‡Øç‡Æµ‡Øà',
            getRecipe: '‡Æö‡ØÜ‡ÆØ‡Øç‡ÆÆ‡ØÅ‡Æ±‡Øà‡ÆØ‡Øà‡Æ™‡Øç ‡Æ™‡ØÜ‡Æ±‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç',
            ingredientsTitle: '‡Æ§‡Øá‡Æµ‡Øà‡ÆØ‡Ææ‡Æ© ‡Æ™‡Øä‡Æ∞‡ØÅ‡Æü‡Øç‡Æï‡Æ≥‡Øç',
            instructionsTitle: '‡Æö‡ØÜ‡ÆØ‡Øç‡ÆÆ‡ØÅ‡Æ±‡Øà',
            cookingTime: '‡Æö‡ÆÆ‡Øà‡ÆØ‡Æ≤‡Øç ‡Æ®‡Øá‡Æ∞‡ÆÆ‡Øç',
        },
        'en': {
            loginTitle: 'üîíLogin',
            usernamePlaceholder: 'Username',
            passwordPlaceholder: 'Password',
            loginButton: 'Log In',
            loginError: 'Please enter a username and password.',
            allFeaturesTitle: 'All Health Features',
            backToFeatures: 'Back to Features',
            featureNotDeveloped: 'This feature is not yet developed.',
            mainMenuTitle: 'Main Menu',
            stepTracker: 'Step Tracker',
            heartRate: 'Heart Rate',
            waterIntake: 'Water Intake',
            moodJournal: 'Mood & Gratitude Journal',
            medicationReminder: 'Medication Reminder',
            foodPlan: 'Food Plan',
            exerciseYoga: 'Exercise & Yoga',
            bodyPainMap: 'Body Pain Map',
            generalTips: 'General Health Tips',
            localTips: 'Local Health Tips',
            beautyTips: 'Home Beauty Tips',
            symptomFinder: 'Symptom Finder AI',
            firstAid: 'First Aid & Emergency',
            foodRecipes: 'Food Recipes',
            search: 'Search',
            submit: 'Submit',
            yourTipHere: 'Your tip will appear here.',
            noRecipe: 'No recipe available. Please try again.',
            loadingMessage: 'Generating AI tip...',
            inputPlaceholderGeneral: 'Get the general health tips you want.',
            inputPlaceholderBeauty: 'Get the beauty tips you want.',
            inputPlaceholderLocal: 'Get the local health tips you want.',
            inputPlaceholderSymptom: 'Get information about your symptoms.',
            inputPlaceholderRecipes: 'Enter a food name or ingredients to get the recipe.',
            getTip: 'Get Tips',
            stepsCount: 'Steps: ',
            startTracking: 'Start Tracking',
            stopTracking: 'Stop Tracking',
            reset: 'Reset Steps',
            stepMotivation: 'Walking 10,000 steps a day can significantly improve your health.',
            journalPrompt: 'Record your mood and things you are grateful for daily.',
            moodSelect: '-- Select a mood --',
            moodHappy: 'Happy',
            moodSad: 'Sad',
            moodNormal: 'Normal',
            moodAnxious: 'Anxious',
            moodGrateful: 'Grateful',
            saveEntry: 'Save Entry',
            analyzeMood: 'Analyze Mood',
            moodAnalysis: 'Mood Analysis',
            moodAnalysisPlaceholder: 'Your mood analysis will appear here.',
            yourEntries: 'Your Entries',
            entriesPlaceholder: 'Your journal entries will appear here.',
            foodPlanPrompt: 'Enter your diet, health, allergy or problem.',
            painMapPrompt: 'Touch the area of your body where you have pain to add the pain and its description.',
            removePain: 'You can touch it again to remove the pain.',
            aiTipTitle: 'AI Tip',
            firstAidPrompt: 'Get help and information in emergencies.',
            emergencyContacts: 'Emergency Contacts',
            addContact: 'Add Contact',
            noContacts: 'No emergency contacts added.',
            symptomPrompt: 'Get information about your symptoms.',
            exercisePrompt: 'Enter your exercise, pain or problem for ideas.',
            painPromptPrefix: 'Tips for this body part pain:',
            painMapTipInstructions: 'Touch a painful area to get tips about it.',
            genericPainTip: 'Touch a body part to get tips for pain in that area.',
            micListening: 'Listening...',
            micStopped: 'Microphone stopped.',
            speakTip: 'Speak Tip',
            stopSpeaking: 'Stop Speaking',
            motionSensorNotSupported: 'Your device does not support motion sensors.',
            emergencyTip: 'Emergency Tip',
            viewFront: 'Front View',
            viewBack: 'Back View',
            getRecipe: 'Get Recipe',
            ingredientsTitle: 'Ingredients',
            instructionsTitle: 'Instructions',
            cookingTime: 'Cooking Time',
        }
    };
    
    // ‡Æ™‡ØÅ‡Æ§‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü ‡ÆÖ‡ÆÆ‡Øç‡Æö‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ™‡Æü‡Øç‡Æü‡Æø‡ÆØ‡Æ≤‡Øç
    const features = [
        { id: 'stepTracker', icon: 'fa-walking', titleKey: 'stepTracker', color: 'bg-green-500' },
        { id: 'generalTips', icon: 'fa-lightbulb', titleKey: 'generalTips', color: 'bg-yellow-500' },
        { id: 'symptomFinder', icon: 'fa-stethoscope', titleKey: 'symptomFinder', color: 'bg-blue-500' },
        { id: 'firstAid', icon: 'fa-hand-holding-medical', titleKey: 'firstAid', color: 'bg-red-500' },
        { id: 'localTips', icon: 'fa-seedling', titleKey: 'localTips', color: 'bg-lime-500' },
        { id: 'foodPlan', icon: 'fa-apple-alt', titleKey: 'foodPlan', color: 'bg-orange-500' },
        { id: 'foodRecipes', icon: 'fa-utensils', titleKey: 'foodRecipes', color: 'bg-amber-500' },
        { id: 'beautyTips', icon: 'fa-spa', titleKey: 'beautyTips', color: 'bg-pink-500' },
        { id: 'exerciseYoga', icon: 'fa-running', titleKey: 'exerciseYoga', color: 'bg-indigo-500' },
        { id: 'bodyPainMap', icon: 'fa-user-injured', titleKey: 'bodyPainMap', color: 'bg-purple-500' },
        { id: 'moodJournal', icon: 'fa-grin-hearts', titleKey: 'moodJournal', color: 'bg-sky-500' },
    ];

    // Mapping from SVG part IDs to human-readable names for AI prompt generation
    const painMapPartNames = {
        'head-front': { ta: '‡Æ§‡Æ≤‡Øà', en: 'head' },
        'neck-front': { ta: '‡Æï‡Æ¥‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ', en: 'neck' },
        'chest': { ta: '‡ÆÆ‡Ææ‡Æ∞‡Øç‡Æ™‡ØÅ', en: 'chest' },
        'stomach': { ta: '‡Æµ‡ÆØ‡Æø‡Æ±‡ØÅ', en: 'stomach' },
        'shoulder-r-front': { ta: '‡Æµ‡Æ≤‡Æ§‡ØÅ ‡Æ§‡Øã‡Æ≥‡Øç‡Æ™‡Æü‡Øç‡Æü‡Øà', en: 'right shoulder' },
        'shoulder-l-front': { ta: '‡Æá‡Æü‡Æ§‡ØÅ ‡Æ§‡Øã‡Æ≥‡Øç‡Æ™‡Æü‡Øç‡Æü‡Øà', en: 'left shoulder' },
        'arm-r-front': { ta: '‡Æµ‡Æ≤‡Æ§‡ØÅ ‡Æï‡Øà', en: 'right arm' },
        'arm-l-front': { ta: '‡Æá‡Æü‡Æ§‡ØÅ ‡Æï‡Øà', en: 'left arm' },
        'elbow-r-front': { ta: '‡Æµ‡Æ≤‡Æ§‡ØÅ ‡ÆÆ‡ØÅ‡Æ¥‡Æô‡Øç‡Æï‡Øà', en: 'right elbow' },
        'elbow-l-front': { ta: '‡Æá‡Æü‡Æ§‡ØÅ ‡ÆÆ‡ØÅ‡Æ¥‡Æô‡Øç‡Æï‡Øà', en: 'left elbow' },
        'forearm-r-front': { ta: '‡Æµ‡Æ≤‡Æ§‡ØÅ ‡ÆÆ‡ØÅ‡Æ©‡Øç‡Æï‡Øà', en: 'right forearm' },
        'forearm-l-front': { ta: '‡Æá‡Æü‡Æ§‡ØÅ ‡ÆÆ‡ØÅ‡Æ©‡Øç‡Æï‡Øà', en: 'left forearm' },
        'hand-r-front': { ta: '‡Æµ‡Æ≤‡Æ§‡ØÅ ‡Æï‡Øà', en: 'right hand' },
        'hand-l-front': { ta: '‡Æá‡Æü‡Æ§‡ØÅ ‡Æï‡Øà', en: 'left hand' },
        'waist-front': { ta: '‡Æá‡Æü‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ', en: 'waist' },
        'thigh-r-front': { ta: '‡Æµ‡Æ≤‡Æ§‡ØÅ ‡Æ§‡Øä‡Æü‡Øà', en: 'right thigh' },
        'thigh-l-front': { ta: '‡Æá‡Æü‡Æ§‡ØÅ ‡Æ§‡Øä‡Æü‡Øà', en: 'left thigh' },
        'knee-r-front': { ta: '‡Æµ‡Æ≤‡Æ§‡ØÅ ‡ÆÆ‡ØÅ‡Æ¥‡Æô‡Øç‡Æï‡Ææ‡Æ≤‡Øç', en: 'right knee' },
        'knee-l-front': { ta: '‡Æá‡Æü‡Æ§‡ØÅ ‡ÆÆ‡ØÅ‡Æ¥‡Æô‡Øç‡Æï‡Ææ‡Æ≤‡Øç', en: 'left knee' },
        'shin-r-front': { ta: '‡Æµ‡Æ≤‡Æ§‡ØÅ ‡Æï‡Ææ‡Æ≤‡Øç', en: 'right shin' },
        'shin-l-front': { ta: '‡Æá‡Æü‡Æ§‡ØÅ ‡Æï‡Ææ‡Æ≤‡Øç', en: 'left shin' },
        'ankle-r-front': { ta: '‡Æµ‡Æ≤‡Æ§‡ØÅ ‡Æï‡Æ£‡ØÅ‡Æï‡Øç‡Æï‡Ææ‡Æ≤‡Øç', en: 'right ankle' },
        'ankle-l-front': { ta: '‡Æá‡Æü‡Æ§‡ØÅ ‡Æï‡Æ£‡ØÅ‡Æï‡Øç‡Æï‡Ææ‡Æ≤‡Øç', en: 'left ankle' },
        'foot-r-front': { ta: '‡Æµ‡Æ≤‡Æ§‡ØÅ ‡Æ™‡Ææ‡Æ§‡ÆÆ‡Øç', en: 'right foot' },
        'foot-l-front': { ta: '‡Æá‡Æü‡Æ§‡ØÅ ‡Æ™‡Ææ‡Æ§‡ÆÆ‡Øç', en: 'left foot' },

        // Back View
        'head-back': { ta: '‡Æ§‡Æ≤‡Øà', en: 'head' },
        'neck-back': { ta: '‡Æï‡Æ¥‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ', en: 'neck' },
        'back': { ta: '‡ÆÆ‡ØÅ‡Æ§‡ØÅ‡Æï‡ØÅ', en: 'back' },
        'buttocks': { ta: '‡Æ™‡Æø‡Æü‡Øç‡Æü‡ÆÆ‡Øç', en: 'buttocks' },
        'shoulder-r-back': { ta: '‡Æµ‡Æ≤‡Æ§‡ØÅ ‡Æ§‡Øã‡Æ≥‡Øç‡Æ™‡Æü‡Øç‡Æü‡Øà', en: 'right shoulder' },
        'shoulder-l-back': { ta: '‡Æá‡Æü‡Æ§‡ØÅ ‡Æ§‡Øã‡Æ≥‡Øç‡Æ™‡Æü‡Øç‡Æü‡Øà', en: 'left shoulder' },
        'arm-r-back': { ta: '‡Æµ‡Æ≤‡Æ§‡ØÅ ‡Æï‡Øà', en: 'right arm' },
        'arm-l-back': { ta: '‡Æá‡Æü‡Æ§‡ØÅ ‡Æï‡Øà', en: 'left arm' },
        'elbow-r-back': { ta: '‡Æµ‡Æ≤‡Æ§‡ØÅ ‡ÆÆ‡ØÅ‡Æ¥‡Æô‡Øç‡Æï‡Øà', en: 'right elbow' },
        'elbow-l-back': { ta: '‡Æá‡Æü‡Æ§‡ØÅ ‡ÆÆ‡ØÅ‡Æ¥‡Æô‡Øç‡Æï‡Øà', en: 'left elbow' },
        'forearm-r-back': { ta: '‡Æµ‡Æ≤‡Æ§‡ØÅ ‡ÆÆ‡ØÅ‡Æ©‡Øç‡Æï‡Øà', en: 'right forearm' },
        'forearm-l-back': { ta: '‡Æá‡Æü‡Æ§‡ØÅ ‡ÆÆ‡ØÅ‡Æ©‡Øç‡Æï‡Øà', en: 'left forearm' },
        'hand-r-back': { ta: '‡Æµ‡Æ≤‡Æ§‡ØÅ ‡Æï‡Øà', en: 'right hand' },
        'hand-l-back': { ta: '‡Æá‡Æü‡Æ§‡ØÅ ‡Æï‡Øà', en: 'left hand' },
        'waist-back': { ta: '‡Æá‡Æü‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ', en: 'waist' },
        'thigh-r-back': { ta: '‡Æµ‡Æ≤‡Æ§‡ØÅ ‡Æ§‡Øä‡Æü‡Øà', en: 'right thigh' },
        'thigh-l-back': { ta: '‡Æá‡Æü‡Æ§‡ØÅ ‡Æ§‡Øä‡Æü‡Øà', en: 'left thigh' },
        'knee-r-back': { ta: '‡Æµ‡Æ≤‡Æ§‡ØÅ ‡ÆÆ‡ØÅ‡Æ¥‡Æô‡Øç‡Æï‡Ææ‡Æ≤‡Øç', en: 'right knee' },
        'knee-l-back': { ta: '‡Æá‡Æü‡Æ§‡ØÅ ‡ÆÆ‡ØÅ‡Æ¥‡Æô‡Øç‡Æï‡Ææ‡Æ≤‡Øç', en: 'left knee' },
        'calf-r-back': { ta: '‡Æµ‡Æ≤‡Æ§‡ØÅ ‡Æï‡Æ©‡Øç‡Æ±‡ØÅ', en: 'right calf' },
        'calf-l-back': { ta: '‡Æá‡Æü‡Æ§‡ØÅ ‡Æï‡Æ©‡Øç‡Æ±‡ØÅ', en: 'left calf' },
        'ankle-r-back': { ta: '‡Æµ‡Æ≤‡Æ§‡ØÅ ‡Æï‡Æ£‡ØÅ‡Æï‡Øç‡Æï‡Ææ‡Æ≤‡Øç', en: 'right ankle' },
        'ankle-l-back': { ta: '‡Æá‡Æü‡Æ§‡ØÅ ‡Æï‡Æ£‡ØÅ‡Æï‡Øç‡Æï‡Ææ‡Æ≤‡Øç', en: 'left ankle' },
        'foot-r-back': { ta: '‡Æµ‡Æ≤‡Æ§‡ØÅ ‡Æ™‡Ææ‡Æ§‡ÆÆ‡Øç', en: 'right foot' },
        'foot-l-back': { ta: '‡Æá‡Æü‡Æ§‡ØÅ ‡Æ™‡Ææ‡Æ§‡ÆÆ‡Øç', en: 'left foot' },
    };

    let currentPage = 'login';
    let currentLang = 'ta';
    let steps = 0;
    let isTracking = false;
    let lastAcceleration = { x: 0, y: 0, z: 0 };
    const stepThreshold = 1.2; // Adjusted threshold for better step detection
    let stepCooldown = false;
    let cooldownTimer = null;
    let stepTrackerHandler = null;
    const moodEntries = [];
    const foodPlan = [];
    const emergencyContacts = [];
    const painMapState = {};
    let isFrontView = true;

    const getTranslation = (key) => translations[currentLang][key] || key;
    const appContainer = document.getElementById('app');
    const bottomBar = document.getElementById('bottom-bar');
    const messageBox = document.getElementById('message-box');
    const messageText = document.getElementById('message-text');

    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    const synth = window.speechSynthesis;

    let recognition = null;
    let isListening = false;
    let isSpeaking = false;

    function showMessageBox(message) {
        messageText.textContent = message;
        messageBox.classList.remove('hidden');
        messageBox.classList.add('flex');
    }

    function closeMessageBox() {
        messageBox.classList.add('hidden');
        messageBox.classList.remove('flex');
    }

    const toggleSpeechRecognition = (inputElementId, buttonElement) => {
        const aiTipElement = document.getElementById('tipOutput') || document.getElementById('recipeOutput');
        const input = document.getElementById(inputElementId);

        if (!SpeechRecognition) {
            showMessageBox('‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æâ‡Æ≤‡Ææ‡Æµ‡Æø ‡Æ™‡Øá‡Æö‡Øç‡Æö‡ØÅ ‡ÆÖ‡Æô‡Øç‡Æï‡ØÄ‡Æï‡Ææ‡Æ∞‡Æ§‡Øç‡Æ§‡Øà ‡ÆÜ‡Æ§‡Æ∞‡Æø‡Æï‡Øç‡Æï‡Æµ‡Æø‡Æ≤‡Øç‡Æ≤‡Øà. (Your browser does not support Speech Recognition).');
            return;
        }

        if (isListening) {
            recognition.stop();
            isListening = false;
            buttonElement.innerHTML = '<i class="fas fa-microphone"></i>';
            if (aiTipElement) {
                aiTipElement.textContent = getTranslation('micStopped');
            }
        } else {
            recognition = new SpeechRecognition();
            recognition.lang = currentLang === 'ta' ? 'ta-IN' : 'en-US';
            recognition.interimResults = false;
            recognition.maxAlternatives = 1;

            recognition.onstart = () => {
                isListening = true;
                buttonElement.innerHTML = '<i class="fas fa-microphone-slash"></i>';
                if (aiTipElement) {
                    aiTipElement.textContent = getTranslation('micListening');
                }
            };

            recognition.onresult = (event) => {
                const speechResult = event.results[0][0].transcript;
                if (input) {
                    input.value = speechResult;
                }
                if (aiTipElement) {
                    aiTipElement.textContent = '';
                }
            };

            recognition.onerror = (event) => {
                console.error('Speech recognition error', event.error);
                showMessageBox(`‡Æ™‡Øá‡Æö‡Øç‡Æö‡ØÅ ‡ÆÖ‡Æô‡Øç‡Æï‡ØÄ‡Æï‡Ææ‡Æ∞‡ÆÆ‡Øç ‡Æ™‡Æø‡Æ¥‡Øà: ${event.error}. (Speech recognition error: ${event.error})`);
            };

            recognition.onend = () => {
                isListening = false;
                buttonElement.innerHTML = '<i class="fas fa-microphone"></i>';
                if (aiTipElement && aiTipElement.textContent === getTranslation('micListening')) {
                    aiTipElement.textContent = '';
                }
            };

            recognition.start();
        }
    };

    const toggleSpeak = (text, buttonElement) => {
        if (!synth) {
            showMessageBox('‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æâ‡Æ≤‡Ææ‡Æµ‡Æø ‡Æ™‡Øá‡Æö‡Øç‡Æö‡ØÅ ‡Æ§‡Øä‡Æï‡ØÅ‡Æ™‡Øç‡Æ™‡Øà ‡ÆÜ‡Æ§‡Æ∞‡Æø‡Æï‡Øç‡Æï‡Æµ‡Æø‡Æ≤‡Øç‡Æ≤‡Øà. (Your browser does not support speech synthesis).');
            return;
        }

        if (isSpeaking) {
            synth.cancel();
            isSpeaking = false;
            buttonElement.innerHTML = '<i class="fas fa-volume-up"></i>';
        } else {
            if (!text || text.trim() === getTranslation('yourTipHere') || text.trim() === getTranslation('noRecipe') || text.trim() === getTranslation('loadingMessage')) {
                showMessageBox('‡Æ™‡Øá‡Æö ‡Æé‡Æ§‡ØÅ‡Æµ‡ØÅ‡ÆÆ‡Øç ‡Æá‡Æ≤‡Øç‡Æ≤‡Øà.');
                return;
            }

            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = currentLang === 'ta' ? 'ta-IN' : 'en-US';

            utterance.onstart = () => {
                isSpeaking = true;
                buttonElement.innerHTML = '<i class="fas fa-volume-mute"></i>';
            };

            utterance.onend = () => {
                isSpeaking = false;
                buttonElement.innerHTML = '<i class="fas fa-volume-up"></i>';
            };

            synth.speak(utterance);
        }
    };
    
    // Function to parse and format general AI tips
    const parseTipsAsList = (tipText) => {
        const lines = tipText.split('\n').filter(line => line.trim() !== '');
        
        let html = '';
        if (lines.length > 1) {
            html += '<ol class="list-decimal list-inside space-y-2 mt-4 text-left">';
            lines.forEach(line => {
                const cleanedLine = line.replace(/^\s*(\d+\.|\*|-)\s*/, '').trim();
                if (cleanedLine) {
                    html += `<li class="text-gray-700">${cleanedLine}</li>`;
                }
            });
            html += '</ol>';
        } else {
            html = `<p class="text-gray-700 mt-4 text-center">${tipText}</p>`;
        }
        return html;
    };

    // New function to parse and format AI recipes from JSON
    const parseRecipe = (recipe) => {
        let html = '';

        if (!recipe || !recipe.ingredients || !recipe.instructions) {
            html = `<p class="text-gray-700 mt-4 text-center">${getTranslation('noRecipe')}</p>`;
            return html;
        }

        html += `<h2 class="text-2xl font-bold mt-4 mb-2 text-gray-800">${recipe.recipeName || '‡Æö‡ØÜ‡ÆØ‡Øç‡ÆÆ‡ØÅ‡Æ±‡Øà'}</h2>`;
        
        if (recipe.cookingTime) {
            html += `<p class="text-md text-gray-600 mb-4"><i class="fas fa-clock mr-2"></i>${getTranslation('cookingTime')}: ${recipe.cookingTime}</p>`;
        }
        
        // Ingredients
        html += `<h3 class="text-xl font-bold mt-4 mb-2 text-gray-800">${getTranslation('ingredientsTitle')}</h3>`;
        html += '<ul class="list-disc list-inside space-y-1 text-left">';
        recipe.ingredients.forEach(line => {
            html += `<li class="text-gray-700">${line.trim()}</li>`;
        });
        html += '</ul>';
        
        // Instructions
        html += `<h3 class="text-xl font-bold mt-4 mb-2 text-gray-800">${getTranslation('instructionsTitle')}</h3>`;
        html += '<ol class="list-decimal list-inside space-y-2 text-left">';
        recipe.instructions.forEach(line => {
            html += `<li class="text-gray-700">${line.trim()}</li>`;
        });
        html += '</ol>';

        return html;
    };

    const getAiTipFromPrompt = async (prompt, outputId) => {
        const outputElement = document.getElementById(outputId);
        outputElement.innerHTML = `<div class="loading-spinner"></div> <span class="ml-2">${getTranslation('loadingMessage')}</span>`;

        const finalPrompt = `${prompt}
Please provide a response in ${currentLang === 'ta' ? 'Tamil' : 'English'}. Format the response as a detailed, step-by-step numbered list. Add some relevant emojis for each step. Do not include any introductory or concluding sentences outside of the list.`;

        try {
            const chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: finalPrompt }] });
            const payload = { contents: chatHistory };

            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(`API call failed with status: ${response.status}. Message: ${errorData.error.message}`);
            }

            const result = await response.json();

            let tipText = getTranslation('yourTipHere');
            if (result.candidates && result.candidates.length > 0 &&
                result.candidates[0].content && result.candidates[0].content.parts &&
                result.candidates[0].content.parts.length > 0) {
                tipText = result.candidates[0].content.parts[0].text;
            } else {
                tipText = getTranslation('noRecipe');
            }

            outputElement.innerHTML = parseTipsAsList(tipText);
        } catch (error) {
            console.error('Error generating AI tip:', error);
            outputElement.innerHTML = `<p class="text-red-500 text-center">‡Æâ‡Æ§‡Æµ‡Æø‡Æï‡Øç‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡Øà ‡Æâ‡Æ∞‡ØÅ‡Æµ‡Ææ‡Æï‡Øç‡Æï ‡ÆÆ‡ØÅ‡Æü‡Æø‡ÆØ‡Æµ‡Æø‡Æ≤‡Øç‡Æ≤‡Øà: ${error.message}</p>`;
        }
    };
    
    // New function to get a recipe from AI using structured JSON output
    const getAiRecipeFromPrompt = async (prompt, outputId) => {
        const outputElement = document.getElementById(outputId);
        outputElement.innerHTML = `<div class="loading-spinner"></div> <span class="ml-2">${getTranslation('loadingMessage')}</span>`;

        // Create a specific prompt for recipes, requesting ingredients and instructions
        const recipePrompt = `Please generate a recipe for "${prompt}". Include the recipe name, approximate cooking time, a list of ingredients, and a step-by-step list of instructions. Provide the response as a JSON object. The recipe should be in ${currentLang === 'ta' ? 'Tamil' : 'English'}.`;

        try {
            const chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: recipePrompt }] });
            const payload = {
                contents: chatHistory,
                generationConfig: {
                    responseMimeType: "application/json",
                    responseSchema: {
                        type: "OBJECT",
                        properties: {
                            "recipeName": { "type": "STRING" },
                            "cookingTime": { "type": "STRING" },
                            "ingredients": { "type": "ARRAY", "items": { "type": "STRING" } },
                            "instructions": { "type": "ARRAY", "items": { "type": "STRING" } }
                        }
                    }
                }
            };
            
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(`API call failed with status: ${response.status}. Message: ${errorData.error.message}`);
            }

            const result = await response.json();
            let recipeData = null;
            if (result.candidates && result.candidates.length > 0 &&
                result.candidates[0].content && result.candidates[0].content.parts &&
                result.candidates[0].content.parts.length > 0) {
                const jsonText = result.candidates[0].content.parts[0].text;
                try {
                    recipeData = JSON.parse(jsonText);
                } catch (jsonError) {
                    console.error('JSON parse error:', jsonError);
                }
            }
            
            outputElement.innerHTML = parseRecipe(recipeData);

        } catch (error) {
            console.error('Error generating AI recipe:', error);
            outputElement.innerHTML = `<p class="text-red-500 text-center">‡Æö‡ØÜ‡ÆØ‡Øç‡ÆÆ‡ØÅ‡Æ±‡Øà‡ÆØ‡Øà ‡Æâ‡Æ∞‡ØÅ‡Æµ‡Ææ‡Æï‡Øç‡Æï ‡ÆÆ‡ØÅ‡Æü‡Æø‡ÆØ‡Æµ‡Æø‡Æ≤‡Øç‡Æ≤‡Øà: ${error.message}</p>`;
        }
    };

    const render = () => {
        appContainer.innerHTML = '';
        bottomBar.innerHTML = '';

        bottomBar.classList.add('hidden');

        // Stop the motion sensor listener before rendering a new page
        if (stepTrackerHandler) {
            window.removeEventListener('devicemotion', stepTrackerHandler);
            stepTrackerHandler = null;
            isTracking = false;
        }

        switch (currentPage) {
            case 'login':
                renderLoginPage();
                break;
            case 'main':
                renderMainPage();
                break;
            case 'stepTracker':
                renderStepTrackerPage();
                renderBottomBar();
                break;
            case 'moodJournal':
                renderMoodJournalPage();
                renderBottomBar();
                break;
            case 'foodRecipes':
                renderFoodRecipesPage();
                renderBottomBar();
                break;
            case 'bodyPainMap':
                renderBodyPainMapPage();
                renderBottomBar();
                break;
            case 'firstAid':
                renderFirstAidPage();
                renderBottomBar();
                break;
            case 'exerciseYoga':
            case 'beautyTips':
            case 'generalTips':
            case 'localTips':
            case 'symptomFinder':
            case 'foodPlan':
                const featureTitle = getTranslation(currentPage);
                let placeholderKey = currentPage === 'foodPlan' ? 'foodPlanPrompt' : (currentPage === 'exerciseYoga' ? 'exercisePrompt' : `inputPlaceholder${currentPage.charAt(0).toUpperCase() + currentPage.slice(1)}`);
                if (!translations[currentLang][placeholderKey]) {
                    placeholderKey = 'yourTipHere';
                }
                renderAiTipsPage(featureTitle, getTranslation(placeholderKey), currentPage);
                renderBottomBar();
                break;
            default:
                renderSimplePage(getTranslation('featureNotDeveloped'), 'üö´', '');
                break;
        }
    };

    const navigateTo = (page) => {
        currentPage = page;
        render();
    };

    const toggleLanguage = () => {
        currentLang = currentLang === 'ta' ? 'en' : 'ta';
        render();
    };

    const renderBottomBar = () => {
        bottomBar.innerHTML = `
            <button id="backButton" class="bg-gray-200 text-gray-800 p-3 rounded-full shadow-lg hover:bg-gray-300 transition-colors flex items-center justify-center">
                <i class="fa fa-arrow-left"></i>
                <span class="ml-2 font-bold">${getTranslation('backToFeatures')}</span>
            </button>
            <button id="langToggleBottom" class="bg-gray-200 text-gray-800 text-xl p-3 rounded-full shadow-lg hover:bg-gray-300 transition-colors flex items-center justify-center">
                <i class="fa fa-globe"></i>
            </button>
        `;
        bottomBar.classList.remove('hidden');
        document.getElementById('backButton').addEventListener('click', () => navigateTo('main'));
        document.getElementById('langToggleBottom').addEventListener('click', toggleLanguage);
    };

    const renderLoginPage = () => {
        appContainer.innerHTML = `
            <div class="flex items-center justify-center min-h-screen bg-gradient-to-br from-green-500 to-blue-500 p-4">
                <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm transform transition-transform hover:scale-105">
                    <div class="flex justify-end mb-4">
                        <button id="langToggleTop" class="text-gray-500 hover:text-gray-800 focus:outline-none">
                            <i class="fa fa-globe text-xl"></i>
                        </button>
                    </div>
                    <div class="flex flex-col items-center">
                        <h1 class="text-4xl font-extrabold text-gray-800 mb-6">${getTranslation('loginTitle')}</h1>
                        <div class="w-full mb-4">
                            <input type="text" id="username" placeholder="${getTranslation('usernamePlaceholder')}" class="w-full px-4 py-3 rounded-lg bg-gray-100 border-2 border-transparent focus:outline-none focus:border-indigo-500 transition-colors">
                        </div>
                        <div class="w-full mb-6">
                            <input type="password" id="password" placeholder="${getTranslation('passwordPlaceholder')}" class="w-full px-4 py-3 rounded-lg bg-gray-100 border-2 border-transparent focus:outline-none focus:border-indigo-500 transition-colors">
                        </div>
                        <button id="loginButton" class="w-full py-3 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors">
                            ${getTranslation('loginButton')}
                        </button>
                    </div>
                </div>
            </div>
        `;

        document.getElementById('loginButton').addEventListener('click', () => {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            if (username && password) {
                navigateTo('main');
            } else {
                showMessageBox(getTranslation('loginError'));
            }
        });

        document.getElementById('langToggleTop').addEventListener('click', toggleLanguage);
    };

    const renderMainPage = () => {
        const featureHtml = features.map(f => `
            <div id="${f.id}-tile" class="flex flex-col items-center justify-center ${f.color} text-white p-4 rounded-xl shadow-lg transform transition-transform hover:scale-105 active:scale-95 cursor-pointer">
                <i class="fas ${f.icon} text-3xl mb-2"></i>
                <span class="text-sm font-semibold text-center">${getTranslation(f.titleKey)}</span>
            </div>
        `).join('');

        appContainer.innerHTML = `
            <div class="w-full max-w-2xl px-4 py-8">
                <div class="flex justify-between items-center mb-6">
                    <h1 class="text-3xl font-bold text-gray-800">${getTranslation('allFeaturesTitle')}</h1>
                    <button id="langToggleMain" class="text-gray-500 hover:text-gray-800 focus:outline-none">
                        <i class="fa fa-globe text-xl"></i>
                    </button>
                </div>
                <div class="grid grid-cols-3 md:grid-cols-4 gap-4">
                    ${featureHtml}
                </div>
            </div>
        `;
        
        features.forEach(f => {
            const tile = document.getElementById(`${f.id}-tile`);
            if (tile) {
                tile.addEventListener('click', () => {
                    navigateTo(f.id);
                });
            }
        });
        document.getElementById('langToggleMain').addEventListener('click', toggleLanguage);
    };

    const renderAiTipsPage = (title, placeholderText, featureId) => {
        const feature = features.find(f => f.id === featureId);
        appContainer.innerHTML = `
            <div class="w-full max-w-2xl px-4 py-8">
                <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8 flex flex-col items-center">
                    <h2 class="text-2xl font-bold mb-4 text-gray-800 flex items-center justify-center">
                        ${feature ? `<i class="fas ${feature.icon} text-2xl mr-3" style="color:${feature.color.replace('bg-', '#')};"></i>` : ''}
                        ${title}
                    </h2>
                    <div class="w-full mb-4">
                        <input type="text" id="tipInput" placeholder="${placeholderText}" class="w-full px-4 py-3 rounded-lg bg-gray-100 border-2 border-transparent focus:outline-none focus:border-indigo-500 transition-colors">
                    </div>
                    <div class="flex items-center gap-4 w-full mb-6">
                        <button id="getTipBtn" class="flex-1 py-3 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors">
                            <i class="fas fa-magic"></i> ${getTranslation('getTip')}
                        </button>
                        <button id="micBtn" class="w-12 h-12 rounded-full bg-blue-500 text-white flex items-center justify-center hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-400">
                            <i class="fas fa-microphone"></i>
                        </button>
                    </div>
                    <div class="output-box-container mb-4">
                        <div id="tipOutput" class="output-box text-sm">
                            <p>${getTranslation('yourTipHere')}</p>
                        </div>
                        <div class="output-box-actions flex space-x-2">
                            <button id="copyBtn" class="bg-gray-300 text-gray-700 w-8 h-8 rounded-full flex items-center justify-center hover:bg-gray-400 transition-colors">
                                <i class="fas fa-copy"></i>
                            </button>
                            <button id="speakBtn" class="bg-green-500 text-white w-8 h-8 rounded-full flex items-center justify-center hover:bg-green-600 transition-colors">
                                <i class="fas fa-volume-up"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        `;
        document.getElementById('getTipBtn').addEventListener('click', () => {
            const input = document.getElementById('tipInput').value;
            if (input) {
                getAiTipFromPrompt(input, 'tipOutput');
            }
        });
        document.getElementById('micBtn').addEventListener('click', (e) => toggleSpeechRecognition('tipInput', e.currentTarget));
        document.getElementById('speakBtn').addEventListener('click', (e) => {
            const tipText = document.getElementById('tipOutput').innerText;
            toggleSpeak(tipText, e.currentTarget);
        });
        document.getElementById('copyBtn').addEventListener('click', () => {
            const tipText = document.getElementById('tipOutput').innerText;
            try {
                navigator.clipboard.writeText(tipText);
                showMessageBox("‡Æâ‡Æ§‡Æµ‡Æø‡Æï‡Øç‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡ØÅ ‡Æ®‡Æï‡Æ≤‡ØÜ‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü‡Æ§‡ØÅ.");
            } catch (err) {
                const tempTextarea = document.createElement('textarea');
                tempTextarea.value = tipText;
                document.body.appendChild(tempTextarea);
                tempTextarea.select();
                document.execCommand('copy');
                document.body.removeChild(tempTextarea);
                showMessageBox("‡Æâ‡Æ§‡Æµ‡Æø‡Æï‡Øç‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡ØÅ ‡Æ®‡Æï‡Æ≤‡ØÜ‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü‡Æ§‡ØÅ.");
            }
        });
    };

    const renderFoodRecipesPage = () => {
        const feature = features.find(f => f.id === 'foodRecipes');
        appContainer.innerHTML = `
            <div class="w-full max-w-2xl px-4 py-8">
                <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8 flex flex-col items-center">
                    <h2 class="text-2xl font-bold mb-4 text-gray-800 flex items-center justify-center">
                        ${feature ? `<i class="fas ${feature.icon} text-2xl mr-3" style="color:${feature.color.replace('bg-', '#')};"></i>` : ''}
                        ${getTranslation('foodRecipes')}
                    </h2>
                    <div class="w-full mb-4">
                        <input type="text" id="recipeInput" placeholder="${getTranslation('inputPlaceholderRecipes')}" class="w-full px-4 py-3 rounded-lg bg-gray-100 border-2 border-transparent focus:outline-none focus:border-indigo-500 transition-colors">
                    </div>
                    <div class="flex items-center gap-4 w-full mb-6">
                        <button id="getRecipeBtn" class="flex-1 py-3 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors">
                            <i class="fas fa-magic"></i> ${getTranslation('getRecipe')}
                        </button>
                        <button id="micBtn" class="w-12 h-12 rounded-full bg-blue-500 text-white flex items-center justify-center hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-400">
                            <i class="fas fa-microphone"></i>
                        </button>
                    </div>
                    <div class="output-box-container mb-4">
                        <div id="recipeOutput" class="output-box text-sm text-left">
                            <p>${getTranslation('yourTipHere')}</p>
                        </div>
                        <div class="output-box-actions flex space-x-2">
                            <button id="copyBtn" class="bg-gray-300 text-gray-700 w-8 h-8 rounded-full flex items-center justify-center hover:bg-gray-400 transition-colors">
                                <i class="fas fa-copy"></i>
                            </button>
                            <button id="speakBtn" class="bg-green-500 text-white w-8 h-8 rounded-full flex items-center justify-center hover:bg-green-600 transition-colors">
                                <i class="fas fa-volume-up"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        `;
        document.getElementById('getRecipeBtn').addEventListener('click', () => {
            const input = document.getElementById('recipeInput').value;
            if (input) {
                getAiRecipeFromPrompt(input, 'recipeOutput');
            }
        });
        document.getElementById('micBtn').addEventListener('click', (e) => toggleSpeechRecognition('recipeInput', e.currentTarget));
        document.getElementById('speakBtn').addEventListener('click', (e) => {
            const recipeText = document.getElementById('recipeOutput').innerText;
            toggleSpeak(recipeText, e.currentTarget);
        });
        document.getElementById('copyBtn').addEventListener('click', () => {
            const recipeText = document.getElementById('recipeOutput').innerText;
            try {
                navigator.clipboard.writeText(recipeText);
                showMessageBox("‡Æö‡ØÜ‡ÆØ‡Øç‡ÆÆ‡ØÅ‡Æ±‡Øà ‡Æ®‡Æï‡Æ≤‡ØÜ‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü‡Æ§‡ØÅ.");
            } catch (err) {
                const tempTextarea = document.createElement('textarea');
                tempTextarea.value = recipeText;
                document.body.appendChild(tempTextarea);
                tempTextarea.select();
                document.execCommand('copy');
                document.body.removeChild(tempTextarea);
                showMessageBox("‡Æö‡ØÜ‡ÆØ‡Øç‡ÆÆ‡ØÅ‡Æ±‡Øà ‡Æ®‡Æï‡Æ≤‡ØÜ‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü‡Æ§‡ØÅ.");
            }
        });
    };

    const renderStepTrackerPage = () => {
        const feature = features.find(f => f.id === 'stepTracker');
        appContainer.innerHTML = `
            <div class="w-full max-w-md px-4 py-8 flex flex-col items-center">
                <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8 w-full">
                    <h2 class="text-2xl font-bold mb-4 text-gray-800 flex items-center justify-center">
                        ${feature ? `<i class="fas ${feature.icon} text-2xl mr-3" style="color:${feature.color.replace('bg-', '#')};"></i>` : ''}
                        ${getTranslation('stepTracker')}
                    </h2>
                    <div class="flex items-center justify-center mb-6">
                        <i class="fas fa-walking text-6xl text-green-500 animate-pulse"></i>
                    </div>
                    <div class="text-center">
                        <h3 class="text-4xl font-extrabold text-green-600 mb-2" id="stepCount">${steps}</h3>
                        <p class="text-lg text-gray-600">${getTranslation('stepsCount')}</p>
                    </div>
                    <p class="text-center text-sm text-gray-400 mt-4">${getTranslation('stepMotivation')}</p>
                    <div class="flex justify-center gap-4 mt-6">
                        <button id="toggleTrackingBtn" class="py-2 px-6 bg-green-500 text-white font-semibold rounded-lg hover:bg-green-600 transition-colors">
                            ${isTracking ? getTranslation('stopTracking') : getTranslation('startTracking')}
                        </button>
                        <button id="resetStepsBtn" class="py-2 px-6 bg-red-500 text-white font-semibold rounded-lg hover:bg-red-600 transition-colors">
                            ${getTranslation('reset')}
                        </button>
                    </div>
                </div>
            </div>
        `;
        document.getElementById('toggleTrackingBtn').addEventListener('click', toggleStepTracking);
        document.getElementById('resetStepsBtn').addEventListener('click', () => {
            steps = 0;
            document.getElementById('stepCount').textContent = steps;
        });
    };

    const renderMoodJournalPage = () => {
        const feature = features.find(f => f.id === 'moodJournal');
        appContainer.innerHTML = `
            <div class="w-full max-w-2xl px-4 py-8">
                <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8 flex flex-col items-center">
                    <h2 class="text-2xl font-bold mb-4 text-gray-800 flex items-center justify-center">
                        ${feature ? `<i class="fas ${feature.icon} text-2xl mr-3" style="color:${feature.color.replace('bg-', '#')};"></i>` : ''}
                        ${getTranslation('moodJournal')}
                    </h2>
                    <p class="text-center text-sm text-gray-500 mb-4">${getTranslation('journalPrompt')}</p>
                    <div class="w-full mb-4">
                        <select id="moodSelect" class="w-full px-4 py-3 rounded-lg bg-gray-100 border-2 border-transparent focus:outline-none focus:border-indigo-500 transition-colors">
                            <option value="">${getTranslation('moodSelect')}</option>
                            <option value="happy">${getTranslation('moodHappy')}</option>
                            <option value="sad">${getTranslation('moodSad')}</option>
                            <option value="normal">${getTranslation('moodNormal')}</option>
                            <option value="anxious">${getTranslation('moodAnxious')}</option>
                            <option value="grateful">${getTranslation('moodGrateful')}</option>
                        </select>
                    </div>
                    <div class="w-full mb-4">
                        <textarea id="gratitudeText" rows="4" placeholder="${getTranslation('yourEntries')}" class="w-full px-4 py-3 rounded-lg bg-gray-100 border-2 border-transparent focus:outline-none focus:border-indigo-500 transition-colors"></textarea>
                    </div>
                    <div class="flex justify-center w-full gap-4 mb-6">
                        <button id="saveEntryBtn" class="flex-1 py-3 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors">
                            ${getTranslation('saveEntry')}
                        </button>
                        <button id="analyzeMoodBtn" class="flex-1 py-3 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors">
                            ${getTranslation('analyzeMood')}
                        </button>
                    </div>
                    <div id="moodAnalysisOutput" class="output-box w-full text-center text-gray-700">
                        ${getTranslation('moodAnalysisPlaceholder')}
                    </div>
                </div>
            </div>
        `;
        document.getElementById('saveEntryBtn').addEventListener('click', saveMoodEntry);
        document.getElementById('analyzeMoodBtn').addEventListener('click', analyzeMood);
        renderMoodEntries();
    };

    const renderBodyPainMapPage = () => {
        const feature = features.find(f => f.id === 'bodyPainMap');
        appContainer.innerHTML = `
            <div class="w-full max-w-2xl px-4 py-8">
                <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8 flex flex-col items-center">
                    <h2 class="text-2xl font-bold mb-4 text-gray-800 flex items-center justify-center">
                        ${feature ? `<i class="fas ${feature.icon} text-2xl mr-3" style="color:${feature.color.replace('bg-', '#')};"></i>` : ''}
                        ${getTranslation('bodyPainMap')}
                    </h2>
                    <p class="text-center text-sm text-gray-500 mb-4">${getTranslation('painMapPrompt')}</p>
                    <div class="w-full flex justify-center mb-4">
                        <div class="pain-map-container" id="painMapSvgContainer"></div>
                    </div>
                    <div class="flex justify-center gap-4 w-full mb-6">
                        <button id="viewToggleBtn" class="flex-1 py-3 bg-gray-200 text-gray-800 font-bold rounded-lg hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400 transition-colors">
                            ${getTranslation('viewBack')}
                        </button>
                    </div>
                    <div class="output-box-container w-full">
                        <div id="painTipOutput" class="output-box text-sm text-left">
                            <p>${getTranslation('genericPainTip')}</p>
                        </div>
                    </div>
                </div>
            </div>
        `;
        renderBodySvg();
        document.getElementById('viewToggleBtn').addEventListener('click', () => {
            isFrontView = !isFrontView;
            document.getElementById('viewToggleBtn').textContent = isFrontView ? getTranslation('viewBack') : getTranslation('viewFront');
            renderBodySvg();
        });
    };

    const renderFirstAidPage = () => {
        const feature = features.find(f => f.id === 'firstAid');
        appContainer.innerHTML = `
            <div class="w-full max-w-2xl px-4 py-8">
                <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8 flex flex-col items-center">
                    <h2 class="text-2xl font-bold mb-4 text-gray-800 flex items-center justify-center">
                        ${feature ? `<i class="fas ${feature.icon} text-2xl mr-3" style="color:${feature.color.replace('bg-', '#')};"></i>` : ''}
                        ${getTranslation('firstAid')}
                    </h2>
                    <p class="text-center text-sm text-gray-500 mb-4">${getTranslation('firstAidPrompt')}</p>
                    <div class="w-full mb-4">
                        <input type="text" id="emergencyInput" placeholder="‡Æâ‡Æ§‡Ææ‡Æ∞‡Æ£‡ÆÆ‡Ææ‡Æï: ‡Æ™‡Ææ‡ÆÆ‡Øç‡Æ™‡ØÅ ‡Æï‡Æü‡Æø" class="w-full px-4 py-3 rounded-lg bg-gray-100 border-2 border-transparent focus:outline-none focus:border-indigo-500 transition-colors">
                    </div>
                    <button id="getEmergencyTipBtn" class="w-full py-3 bg-red-600 text-white font-bold rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-colors">
                        <i class="fas fa-plus-square"></i> ${getTranslation('emergencyTip')}
                    </button>
                    <div id="emergencyTipOutput" class="output-box w-full mt-6 text-sm text-left">
                        <p>${getTranslation('yourTipHere')}</p>
                    </div>
                </div>
            </div>
        `;
        document.getElementById('getEmergencyTipBtn').addEventListener('click', () => {
            const input = document.getElementById('emergencyInput').value;
            if (input) {
                getAiTipFromPrompt(`First aid for ${input}`, 'emergencyTipOutput');
            }
        });
    };

    const renderSimplePage = (title, icon, content) => {
        appContainer.innerHTML = `
            <div class="w-full max-w-2xl px-4 py-8">
                <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8 text-center flex flex-col items-center justify-center">
                    <div class="text-6xl mb-4">${icon}</div>
                    <h2 class="text-2xl font-bold mb-4 text-gray-800">${title}</h2>
                    <p class="text-gray-600">${content}</p>
                </div>
            </div>
        `;
        renderBottomBar();
    };

    // Placeholder functions for now
    const toggleStepTracking = () => {
        isTracking = !isTracking;
        const btn = document.getElementById('toggleTrackingBtn');
        if (isTracking) {
            btn.textContent = getTranslation('stopTracking');
            if (window.DeviceMotionEvent) {
                stepTrackerHandler = (event) => {
                    const acceleration = event.accelerationIncludingGravity;
                    const deltaX = Math.abs(acceleration.x - lastAcceleration.x);
                    const deltaY = Math.abs(acceleration.y - lastAcceleration.y);
                    const deltaZ = Math.abs(acceleration.z - lastAcceleration.z);

                    const movement = Math.sqrt(deltaX * deltaX + deltaY * deltaY + deltaZ * deltaZ);

                    if (movement > stepThreshold && !stepCooldown) {
                        steps++;
                        document.getElementById('stepCount').textContent = steps;
                        stepCooldown = true;
                        clearTimeout(cooldownTimer);
                        cooldownTimer = setTimeout(() => {
                            stepCooldown = false;
                        }, 500); // Cooldown period
                    }
                    lastAcceleration = { x: acceleration.x, y: acceleration.y, z: acceleration.z };
                };
                window.addEventListener('devicemotion', stepTrackerHandler);
            } else {
                showMessageBox(getTranslation('motionSensorNotSupported'));
                isTracking = false;
                btn.textContent = getTranslation('startTracking');
            }
        } else {
            btn.textContent = getTranslation('startTracking');
            if (stepTrackerHandler) {
                window.removeEventListener('devicemotion', stepTrackerHandler);
                stepTrackerHandler = null;
            }
        }
    };

    const saveMoodEntry = async () => {
        const mood = document.getElementById('moodSelect').value;
        const gratitude = document.getElementById('gratitudeText').value;
        if (mood || gratitude) {
            moodEntries.push({ date: new Date().toLocaleString(), mood, gratitude });
            renderMoodEntries();
            showMessageBox('‡Æ™‡Æ§‡Æø‡Æµ‡ØÅ ‡Æö‡Øá‡ÆÆ‡Æø‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü‡Æ§‡ØÅ!');
        } else {
            showMessageBox('‡Æ§‡ÆØ‡Æµ‡ØÅ‡Æö‡ØÜ‡ÆØ‡Øç‡Æ§‡ØÅ ‡ÆÆ‡Æ©‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡Øà‡ÆØ‡Øã ‡ÆÖ‡Æ≤‡Øç‡Æ≤‡Æ§‡ØÅ ‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡Øà‡ÆØ‡Øã ‡Æâ‡Æ≥‡Øç‡Æ≥‡Æø‡Æü‡Æµ‡ØÅ‡ÆÆ‡Øç.');
        }
    };

    const analyzeMood = () => {
        const moodOutput = document.getElementById('moodAnalysisOutput');
        if (moodEntries.length === 0) {
            moodOutput.innerHTML = `<p class="text-gray-700">${getTranslation('entriesPlaceholder')}</p>`;
            return;
        }

        const moodCounts = moodEntries.reduce((acc, entry) => {
            acc[entry.mood] = (acc[entry.mood] || 0) + 1;
            return acc;
        }, {});

        let analysisText = `<h3 class="font-bold text-lg mb-2">${getTranslation('moodAnalysis')}</h3>`;
        for (const mood in moodCounts) {
            analysisText += `<p>‚Ä¢ ${getTranslation(`mood${mood.charAt(0).toUpperCase() + mood.slice(1)}`)}: ${moodCounts[mood]} ‡ÆÆ‡ØÅ‡Æ±‡Øà</p>`;
        }
        moodOutput.innerHTML = analysisText;
    };

    const renderMoodEntries = () => {
        const gratitudeTextarea = document.getElementById('gratitudeText');
        if (gratitudeTextarea) {
            gratitudeTextarea.value = moodEntries.map(entry => `[${entry.date}] - ‡ÆÆ‡Æ©‡Æ®‡Æø‡Æ≤‡Øà: ${getTranslation(`mood${entry.mood.charAt(0).toUpperCase() + entry.slice(1)}`)} - ‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡ØÅ: ${entry.gratitude}`).join('\n\n');
        }
    };
    
    const renderBodySvg = () => {
        const svgContainer = document.getElementById('painMapSvgContainer');
        const view = isFrontView ? 'front' : 'back';
        const svgContent = getSvg(view);
        svgContainer.innerHTML = svgContent;

        document.querySelectorAll('.body-part').forEach(path => {
            const partId = path.id;
            // Restore pain state from the map
            if (painMapState[partId]) {
                path.classList.add('pain');
            }
            path.addEventListener('click', (e) => {
                e.stopPropagation(); // Prevents clicks from bubbling up
                path.classList.toggle('pain');
                if (path.classList.contains('pain')) {
                    painMapState[partId] = true;
                    const partName = painMapPartNames[partId][currentLang];
                    getAiTipFromPrompt(`${getTranslation('painPromptPrefix')} ${partName}.`, 'painTipOutput');
                } else {
                    delete painMapState[partId];
                    document.getElementById('painTipOutput').innerHTML = `<p>${getTranslation('genericPainTip')}</p>`;
                }
            });
        });
    };

    const getSvg = (view) => {
        if (view === 'front') {
            return `
                <svg class="pain-map-svg w-full h-auto" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 357 588">
                    <!-- Head -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="head-front" d="M178.5,19c11.8,0,21.5,9.7,21.5,21.5c0,11.8-9.7,21.5-21.5,21.5c-11.8,0-21.5-9.7-21.5-21.5C157,28.7,166.7,19,178.5,19z"/>
                    <!-- Neck -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="neck-front" d="M178.5,62c-7,0-12.7,5.7-12.7,12.7v24c0,7,5.7,12.7,12.7,12.7c7,0,12.7-5.7,12.7-12.7V74.7C191.2,67.7,185.5,62,178.5,62z"/>
                    <!-- Chest -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="chest" d="M178.5,111.4c-35,0-63.5,28.5-63.5,63.5c0,35,28.5,63.5,63.5,63.5c35,0,63.5-28.5,63.5-63.5C242,139.9,213.5,111.4,178.5,111.4z"/>
                    <!-- Arms -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="arm-l-front" d="M115,175.7c-1.3,0-2.4,1.1-2.4,2.4v95.6c0,1.3,1.1,2.4,2.4,2.4s2.4-1.1,2.4-2.4v-95.6C117.4,176.8,116.3,175.7,115,175.7z"/>
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="arm-r-front" d="M242,175.7c-1.3,0-2.4,1.1-2.4,2.4v95.6c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-95.6C244.4,176.8,243.3,175.7,242,175.7z"/>
                    <!-- Elbows -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="elbow-l-front" d="M115,273.7c-1.3,0-2.4,1.1-2.4,2.4v24c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-24C117.4,274.8,116.3,273.7,115,273.7z"/>
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="elbow-r-front" d="M242,273.7c-1.3,0-2.4,1.1-2.4,2.4v24c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-24C244.4,274.8,243.3,273.7,242,273.7z"/>
                    <!-- Forearms -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="forearm-l-front" d="M115,302.7c-1.3,0-2.4,1.1-2.4,2.4v54.7c0,1.3,1.1,2.4,2.4,2.4s2.4-1.1,2.4-2.4v-54.7C117.4,303.8,116.3,302.7,115,302.7z"/>
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="forearm-r-front" d="M242,302.7c-1.3,0-2.4,1.1-2.4,2.4v54.7c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-54.7C244.4,303.8,243.3,302.7,242,302.7z"/>
                    <!-- Hands -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="hand-l-front" d="M115,360.2c-1.3,0-2.4,1.1-2.4,2.4v24c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-24C117.4,361.3,116.3,360.2,115,360.2z"/>
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="hand-r-front" d="M242,360.2c-1.3,0-2.4,1.1-2.4,2.4v24c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-24C244.4,361.3,243.3,360.2,242,360.2z"/>
                    <!-- Stomach -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="stomach" d="M178.5,246.7c-35,0-63.5,28.5-63.5,63.5c0,35,28.5,63.5,63.5,63.5c35,0,63.5-28.5,63.5-63.5C242,275.2,213.5,246.7,178.5,246.7z"/>
                    <!-- Waist -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="waist-front" d="M178.5,373.7c-15.5,0-28.1,12.6-28.1,28.1v24c0,15.5,12.6,28.1,28.1,28.1c15.5,0,28.1-12.6,28.1-28.1v-24C206.6,386.3,194,373.7,178.5,373.7z"/>
                    <!-- Thighs -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="thigh-l-front" d="M140,425.7c-1.3,0-2.4,1.1-2.4,2.4v62.4c0,1.3,1.1,2.4,2.4,2.4s2.4-1.1,2.4-2.4v-62.4C142.4,426.8,141.3,425.7,140,425.7z"/>
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="thigh-r-front" d="M217,425.7c-1.3,0-2.4,1.1-2.4,2.4v62.4c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-62.4C219.4,426.8,218.3,425.7,217,425.7z"/>
                    <!-- Knees -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="knee-l-front" d="M140,490.5c-1.3,0-2.4,1.1-2.4,2.4v24c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-24C142.4,491.6,141.3,490.5,140,490.5z"/>
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="knee-r-front" d="M217,490.5c-1.3,0-2.4,1.1-2.4,2.4v24c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-24C219.4,491.6,218.3,490.5,217,490.5z"/>
                    <!-- Shins -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="shin-l-front" d="M140,519.5c-1.3,0-2.4,1.1-2.4,2.4v54.7c0,1.3,1.1,2.4,2.4,2.4s2.4-1.1,2.4-2.4v-54.7C142.4,520.6,141.3,519.5,140,519.5z"/>
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="shin-r-front" d="M217,519.5c-1.3,0-2.4,1.1-2.4,2.4v54.7c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-54.7C219.4,520.6,218.3,519.5,217,519.5z"/>
                    <!-- Ankles -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="ankle-l-front" d="M140,578.5c-1.3,0-2.4,1.1-2.4,2.4v24c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-24C142.4,579.6,141.3,578.5,140,578.5z"/>
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="ankle-r-front" d="M217,578.5c-1.3,0-2.4,1.1-2.4,2.4v24c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-24C219.4,579.6,218.3,578.5,217,578.5z"/>
                    <!-- Feet -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="foot-l-front" d="M115,607.5c-1.3,0-2.4,1.1-2.4,2.4v24c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-24C117.4,608.6,116.3,607.5,115,607.5z"/>
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="foot-r-front" d="M242,607.5c-1.3,0-2.4,1.1-2.4,2.4v24c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-24C244.4,608.6,243.3,607.5,242,607.5z"/>
                </svg>
            `;
        } else {
            return `
                <svg class="pain-map-svg w-full h-auto" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 357 588">
                    <!-- Head -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="head-back" d="M178.5,19c11.8,0,21.5,9.7,21.5,21.5c0,11.8-9.7,21.5-21.5,21.5c-11.8,0-21.5-9.7-21.5-21.5C157,28.7,166.7,19,178.5,19z"/>
                    <!-- Neck -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="neck-back" d="M178.5,62c-7,0-12.7,5.7-12.7,12.7v24c0,7,5.7,12.7,12.7,12.7c7,0,12.7-5.7,12.7-12.7V74.7C191.2,67.7,185.5,62,178.5,62z"/>
                    <!-- Back -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="back" d="M178.5,111.4c-35,0-63.5,28.5-63.5,63.5c0,35,28.5,63.5,63.5,63.5c35,0,63.5-28.5,63.5-63.5C242,139.9,213.5,111.4,178.5,111.4z"/>
                    <!-- Arms -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="arm-l-back" d="M115,175.7c-1.3,0-2.4,1.1-2.4,2.4v95.6c0,1.3,1.1,2.4,2.4,2.4s2.4-1.1,2.4-2.4v-95.6C117.4,176.8,116.3,175.7,115,175.7z"/>
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="arm-r-back" d="M242,175.7c-1.3,0-2.4,1.1-2.4,2.4v95.6c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-95.6C244.4,176.8,243.3,175.7,242,175.7z"/>
                    <!-- Elbows -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="elbow-l-back" d="M115,273.7c-1.3,0-2.4,1.1-2.4,2.4v24c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-24C117.4,274.8,116.3,273.7,115,273.7z"/>
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="elbow-r-back" d="M242,273.7c-1.3,0-2.4,1.1-2.4,2.4v24c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-24C244.4,274.8,243.3,273.7,242,273.7z"/>
                    <!-- Forearms -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="forearm-l-back" d="M115,302.7c-1.3,0-2.4,1.1-2.4,2.4v54.7c0,1.3,1.1,2.4,2.4,2.4s2.4-1.1,2.4-2.4v-54.7C117.4,303.8,116.3,302.7,115,302.7z"/>
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="forearm-r-back" d="M242,302.7c-1.3,0-2.4,1.1-2.4,2.4v54.7c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-54.7C244.4,303.8,243.3,302.7,242,302.7z"/>
                    <!-- Hands -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="hand-l-back" d="M115,360.2c-1.3,0-2.4,1.1-2.4,2.4v24c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-24C117.4,361.3,116.3,360.2,115,360.2z"/>
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="hand-r-back" d="M242,360.2c-1.3,0-2.4,1.1-2.4,2.4v24c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-24C244.4,361.3,243.3,360.2,242,360.2z"/>
                    <!-- Buttocks -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="buttocks" d="M178.5,246.7c-35,0-63.5,28.5-63.5,63.5c0,35,28.5,63.5,63.5,63.5c35,0,63.5-28.5,63.5-63.5C242,275.2,213.5,246.7,178.5,246.7z"/>
                    <!-- Waist -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="waist-back" d="M178.5,373.7c-15.5,0-28.1,12.6-28.1,28.1v24c0,15.5,12.6,28.1,28.1,28.1c15.5,0,28.1-12.6,28.1-28.1v-24C206.6,386.3,194,373.7,178.5,373.7z"/>
                    <!-- Thighs -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="thigh-l-back" d="M140,425.7c-1.3,0-2.4,1.1-2.4,2.4v62.4c0,1.3,1.1,2.4,2.4,2.4s2.4-1.1,2.4-2.4v-62.4C142.4,426.8,141.3,425.7,140,425.7z"/>
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="thigh-r-back" d="M217,425.7c-1.3,0-2.4,1.1-2.4,2.4v62.4c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-62.4C219.4,426.8,218.3,425.7,217,425.7z"/>
                    <!-- Knees -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="knee-l-back" d="M140,490.5c-1.3,0-2.4,1.1-2.4,2.4v24c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-24C142.4,491.6,141.3,490.5,140,490.5z"/>
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="knee-r-back" d="M217,490.5c-1.3,0-2.4,1.1-2.4,2.4v24c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-24C219.4,491.6,218.3,490.5,217,490.5z"/>
                    <!-- Calves -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="calf-l-back" d="M140,519.5c-1.3,0-2.4,1.1-2.4,2.4v54.7c0,1.3,1.1,2.4,2.4,2.4s2.4-1.1,2.4-2.4v-54.7C142.4,520.6,141.3,519.5,140,519.5z"/>
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="calf-r-back" d="M217,519.5c-1.3,0-2.4,1.1-2.4,2.4v54.7c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-54.7C219.4,520.6,218.3,519.5,217,519.5z"/>
                    <!-- Ankles -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="ankle-l-back" d="M140,578.5c-1.3,0-2.4,1.1-2.4,2.4v24c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-24C142.4,579.6,141.3,578.5,140,578.5z"/>
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="ankle-r-back" d="M217,578.5c-1.3,0-2.4,1.1-2.4,2.4v24c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-24C219.4,579.6,218.3,578.5,217,578.5z"/>
                    <!-- Feet -->
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="foot-l-back" d="M115,607.5c-1.3,0-2.4,1.1-2.4,2.4v24c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-24C117.4,608.6,116.3,607.5,115,607.5z"/>
                    <path class="body-part fill-gray-300 stroke-gray-500 stroke-2" id="foot-r-back" d="M242,607.5c-1.3,0-2.4,1.1-2.4,2.4v24c0,1.3,1.1,2.4,2.4,2.4c1.3,0,2.4-1.1,2.4-2.4v-24C244.4,608.6,243.3,607.5,242,607.5z"/>
                </svg>
            `;
        }
    };
    
    // Initial render
    window.onload = () => {
        render();
    };

</script>

</body>
</html>
